<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<link rel="icon" type="image/x-icon" href="/home/aka/Downloads/chess.webp">
<title>N×N Queen</title>
<style>  
 .board {
    --n: 4;
    --size: 50px;
    display: grid;
    grid-template-columns: repeat(var(--n), var(--size));
    width: calc(var(--n) * var(--size));
    border: 4px solid #0f00e4;
    opacity: 0.7;
  }

  .square {
    width: var(--size);
    height: var(--size);
    display: grid;
    place-items: center;
    font-size: calc(var(--size) * 0.8);
    user-select: none;      
  }

  .dfatherbody {
    --n: var(--n);  
    --size:50px;
    width: calc(var(--n) * var(--size));
    background-image: url("./images/back.jpg");
    background-position: center;
    background-repeat: no-repeat;
    animation: normal;
  }

  
  .Akls {
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .light { background:#ffffff; }
  .dark  { background:#757575; color:#803c3c; }
  .controls { 
    display:flex;
    justify-content: center;
  }

  input[type="number"] { width: 6rem; }
  .ddd {
    display: flex;
    align-items:center;
    justify-content: center;
    margin: 10px;
  }

  button {
    width: 150px;
    height: 30px;
  }

</style>
</head>
<body>
    <div class="controls">
      <label>Board size (N):
        <input id="n" type="number" value="4" min="1" />
      </label>
    </div>
    <div class="ddd">
      <button id="build">Build</button>
    </div>
  <div class="Akls">
    <div id ="dfatherbody" class="dfatherbody">
      <div class="dbody">
        <div id="board" class="board"></div>
      </div>
    </div>
  <div>
<script>
  const boardEl = document.getElementById('board');
  const nInput  = document.getElementById('n');
  const buildBtn= document.getElementById('build');
  const dfatherbody = document.getElementById('dfatherbody')
  function buildBoard(n) {
    boardEl.style.setProperty('--n', n);
    dfatherbody.style.setProperty('--n', n)
    boardEl.innerHTML = '';
    for (let r = 0; r < n; r++) {
      for (let c = 0; c < n; c++) {
        const sq = document.createElement('div');
        sq.id = String(r+1)+"*"+String(c+1)
        sq.className = 'square ' + ((r + c) % 2 === 0 ? 'light' : 'dark');
        boardEl.appendChild(sq);
      }
    }
  }
  buildBtn.addEventListener('click', () => {
    const n = Number(nInput.value);
    buildBoard(n);
    SendToBackend(n)
  });
async function SendToBackend(nqueenNumber){
    const xhr = new XMLHttpRequest();
    xhr.open("POST", "http://localhost:8000/solve");
    xhr.setRequestHeader("Content-Type", "application/json");
    const body = JSON.stringify({
        number: Number(nqueenNumber)
    });
    xhr.onload = () => {
        if (xhr.readyState == 4 && xhr.status == 200) {
            res = JSON.parse(xhr.responseText);
            list = res["solution"];
            for (x in list){
                for (t in list[x]){
                    const cellId = String(Number(x)+1)+"*"+String(Number(t)+1);
                    const cell = document.getElementById(cellId);
                    cell.innerHTML = list[x][t];
                    if (list[x][t] === "♛" || list[x][t] === "Q") {
                        cell.style.backgroundColor = "lightgreen";
                        cell.style.color = "red";
                        cell.style.fontWeight = "bold";
                    }
                }
            }
        } else {
            console.log(`Error: ${xhr.status}`);
        }
    };
    xhr.send(body);
}

  function ClearElement(elementID){
		document.getElementById(elementID).innerHTML = "";
	}
  const container = document.getElementById("h2ka");
	const newDiv = document.createElement("s");
	newDiv.className = 'sd';
	newDiv.style.setProperty('--n',5);
  buildBoard(4);
</script>
</body>
</html>